<!DOCTYPE html>
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/fullcalendar/1.6.4/fullcalendar.min.js"></script>
<script type="text/javascript" src="scripts/gcal.js"></script>
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/fullcalendar/1.6.4/fullcalendar.css" type="text/css" />
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/fullcalendar/1.6.4/fullcalendar.print.css" />
</head>

<body>

<div id="calendar" style="width:750px;"></div>

<script type="text/javascript">
$(document).ready(function() {

    // page is now ready, initialize the calendar...
    $('#calendar').fullCalendar({
        eventSources: [ 'https://www.google.com/calendar/feeds/7nffm8fujjn1gim5auqnqbbr24%40group.calendar.google.com/public/basic', 
                        "https://www.google.com/calendar/feeds/project101dc%40gmail.com/public/basic"
                      ]
    });


    var fetch_meetups = function(){
        
        var groups = ['Ladies-Who-Code-Washington-DC','Girl-Develop-It-DC', 'dc-pyladies' ]
        var api_url = 'http://api.meetup.com/2/events?order=time&key=2721217a7241b22132f3f30c715f64&group_urlname=NAME&callback=?';

        for (i in groups){
            var group_name = groups[i];
            $.getJSON(api_url.replace('NAME', group_name), 
                function(data, text_status, jqxhr){
                    
                    var events = [];

                    for (e in data['results']) {
                        var event = data['results'][e];
                        var date = new Date(event['time']).toString();
                        var o = {
                           'title': event['group']['name'] + ' - ' + event['name'],
                           'start': date,
                           'url': event['event_url']
                        };
                        events.push(o);
                    }
                    
                    $('#calendar').fullCalendar('addEventSource', events);
                }
            )

        }

    }  

    fetch_meetups();
});

</script>
</body>
</html>
